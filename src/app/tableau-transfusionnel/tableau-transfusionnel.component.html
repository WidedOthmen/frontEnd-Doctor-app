<div id="wrapper">
  <app-side-bar></app-side-bar>
  <div id="content-wrapper" class="d-flex flex-column">
    <div id="content">
      <!-- topbar -->
      <nav class="shadow topbar mb-4 bg-white static-tp navbar-expand navbar navbar-light">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link dropdown" (click)='logoutUser()'>
              <span class="mr-2 d-none d-lg-inline">
                LOGOUT
                <i class="fas fa-sign-out-alt"></i>
              </span>
            </a>
          </li>
        </ul>
      </nav>
      <!-- Page content  -->
      <div class="container-fluid">
        <div class="d-sm-flex align-items-center justify-content-start mb-4">
          <button aria-label="navigate" (click)='navigateToPatient()' class="title">
            <i class="fas fa-chevron-left arrow"></i>
            Détails du patient
          </button>
        </div>
        <div class="card shadow mb-4">
          <div class="card-header py-3 ">
            <h6 class="m-0 font-weight-bold ">TABLEAU TRANSFUSIONNEL</h6>
          </div>
          <div class="card-body" *ngIf="test">
            <div class="row">
              <div class="col-sm-12">
                <table class="table  dataTable" id="dataTable" aria-describedby="dataTable_info"
                  style="width: 100%; border-right-width: 0; border: 1px solid #e3e6f0;">
                  <thead>
                    <tr role="row">
                      <th class="sorting_asc" tabindex="0" aria-controls="dataTable" rowspan="2" aria-sort="ascending"
                        aria-label="Name: activate to sort column descending">
                        Date
                      </th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="2"
                        aria-label="Position: activate to sort column ascending">
                        Volume transfusé(ml)
                      </th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable" colspan="4"
                        aria-label="Position: activate to sort column ascending">
                        N.F.S Pré-transfusionnelle
                      </th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="2"
                        aria-label="Position: activate to sort column ascending">
                        Hb post-transfusionnelle
                      </th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="2"
                        aria-label="Position: activate to sort column ascending">
                        RAI
                      </th>
                    </tr>
                    <tr>
                      <th>Hb</th>
                      <th>PNN</th>
                      <th>Plaquettes</th>
                      <th>Réliculocytes</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr role="row">
                      <td>{{test.date}}</td>
                      <td>{{test.volumetransfuse}}</td>
                      <td>{{test.hb}}</td>
                      <td>{{test.pnn}}</td>
                      <td>{{test.plaquettes}} </td>
                      <td>{{test. reliculocytes}}</td>
                      <td>{{test.hbpost}} </td>
                      <td>{{test.rai}} </td>
                    </tr>
                  </tbody>
                  <thead>
                    <tr role="row">
                      <th class="sorting" tabindex="0" aria-controls="dataTable"
                        aria-label="Position: activate to sort column ascending">
                        CHH
                      </th>
                      <th class="sorting_asc" tabindex="0" aria-controls="dataTable" aria-sort="ascending"
                        aria-label="Name: activate to sort column descending">
                        LDH (U/L)
                      </th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable" colspan="1"
                        aria-label="Position: activate to sort column ascending">
                        Créatinine sérique (µmol/L)
                      </th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable" colspan="1"
                        aria-label="Position: activate to sort column ascending">
                        Glycémie (mmol/L)
                      </th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable" rowspan="1" colspan="1"
                        aria-label="Position: activate to sort column ascending">
                        Autres examen
                      </th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable"
                        aria-label="Position: activate to sort column ascending">
                        Réaction transfusionnelle
                      </th>
                      <th class="sorting" tabindex="0" aria-controls="dataTable"
                        aria-label="Position: activate to sort column ascending">
                        Observations
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr role="row">
                      <td>{{test.chh}}</td>
                      <td>{{test.ldh}} </td>
                      <td>{{test.creatine}}</td>
                      <td>{{test.glycemie}} </td>
                      <td>{{test.autresexamen}} </td>
                      <td>{{test.reaction}} </td>
                      <td>{{test.observations}} </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="icons mt-4 text-center">
              <button aria-label="delete" (click)="delete(test._id)" type="button"
                class="btn btn-outline-danger mr-3"><i class="fas fa-trash-restore"></i></button>
              <button aria-label="update" (click)="openModal(modify)" type="button" class="btn btn-outline-primary"><i
                  class="fas fa-user-edit"></i></button>
            </div>
          </div>
          <!-- modal -->
          <ng-template #modify>
            <div class="modal-content">
              <div class="modal-header">
                <h4 class="title" id="defaultModalLabel">Modifier </h4>
              </div>
              <div class="modal-body">
                <form *ngIf="test">
                  <div class="row">
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Date </label>
                        <input type="date" class="form-control" name="date" [(ngModel)]="test.date" />
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Volume transfusé(ml) </label>
                        <input type="text" class="form-control" name="volumetransfuse"
                          [(ngModel)]="test.volumetransfuse" />
                      </div>
                    </div>
                    <div class="w-100"></div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Hb</label>
                        <input type="text" class="form-control" name="hb" [(ngModel)]="test.hb" />
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>PNN</label>
                        <input type="text" class="form-control" name="pnn" [(ngModel)]="test.pnn" />
                      </div>
                    </div>
                    <div class="w-100"></div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Plaquettes </label>
                        <input type="text" class="form-control" name="plaquettes" [(ngModel)]="test.plaquettes" />
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Réliculocytes</label>
                        <input type="text" class="form-control" name="reliculocytes" [(ngModel)]="test.reliculocytes" />
                      </div>
                    </div>
                    <div class="w-100"></div>
                    <div class="col-md-12">
                      <div class="form-group">
                        <label>Hb post-transfusionnelle</label>
                        <input type="text" class="form-control" name="hbpost" [(ngModel)]="test.hbpost" />
                      </div>
                    </div>
                    <div class="w-100"></div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label> RAI</label>
                        <input type="text" class="form-control" name="rai" [(ngModel)]="test.rai" />
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>CHH</label>
                        <input type="text" class="form-control" name=" chh" [(ngModel)]="test.chh" />
                      </div>
                    </div>
                    <div class="w-100"></div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label> LDH (U/L)</label>
                        <input type="text" class="form-control" name="ldh" [(ngModel)]="test.ldh" />
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Créatinine sérique (µmol/L)</label>
                        <input type="text" class="form-control" name="creatine" [(ngModel)]="test.creatine" />
                      </div>
                    </div>
                    <div class="w-100"></div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Glycémie (mmol/L)</label>
                        <input type="text" class="form-control" name="glycemie" [(ngModel)]="test.glycemie" />
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label> Autres examen</label>
                        <input type="text" class="form-control" name="autresexamen" [(ngModel)]="test.autresexamen" />
                      </div>
                    </div>
                    <div class="w-100"></div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label>Réaction transfusionnelle</label>
                        <input type="text" class="form-control" name="reaction" [(ngModel)]="test.reaction" />
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="form-group">
                        <label> Observations</label>
                        <input type="text" class="form-control" name="observations" [(ngModel)]="test.observations" />
                      </div>
                    </div>
                  </div>
                </form>
              </div>
              <div class="modal-footer">
                <button aria-label="update" type="button" (click)='modifyTest()'
                  class="btn btn-primary">Modifier</button>
                <button aria-label="reset" type="button" (click)="onReset()" class="btn btn-danger"
                  data-dismiss="modal">Annuler</button>
              </div>
            </div>
          </ng-template>
          <div class="card-body" *ngIf="!test">
            <app-formulaire-transfusionnel></app-formulaire-transfusionnel>
          </div>
        </div>
      </div>
    </div>
    <!-- footer -->
    <app-footer></app-footer>
  </div>
</div>
